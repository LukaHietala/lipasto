<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lipasto</title>
</head>
<body>
    <nav>
        <a href="/">Home</a>
        {% set repo_name = request.view_args.get('repo_name') %}
        {% if repo_name %}
            | <a href="{{ url_for('repo_commits', repo_name=repo_name) }}?ref={{ current_ref }}">Commits</a>
            | <a href="{{ url_for('repo_refs', repo_name=repo_name) }}">Refs</a>
            | <a href="{{ url_for('repo_tree_path', repo_name=repo_name) }}?ref={{ current_ref }}">Tree</a>
            | <a href="{{ url_for('repo_diff', repo_name=repo_name) }}?ref={{ current_ref }}">Diff</a>
        {% endif %}
        {% if refs %}
            | Ref:
            <select onchange="changeRef(this.value)">
                {% for ref in refs %}
                <option value="{{ ref.shorthand }}" {% if ref.shorthand == current_ref %}selected{% endif %}>{{ ref.name }}</option>
                {% endfor %}
            </select>
        {% endif %}
    </nav>
    <main>
    {% block content %}{% endblock %}
    </main>
    <script>
    function changeRef(newRef) {
        const url = new URL(window.location);
        url.searchParams.set('ref', newRef);
        window.location = url;
    }
    </script>
</body>
</html>
