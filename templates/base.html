<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lipasto</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <nav>
        <div>
            <a href="/">Back</a>
            {% set repo_name = request.view_args.get('repo_name') %}
            {% if repo_name %}
            <a href="{{ url_for('repo_detail', repo_name=repo_name) }}?ref={{ current_ref }}" {% if request.endpoint == 'repo_detail' %}class="active"{% endif %}>Overview</a>
            <a href="{{ url_for('repo_commits', repo_name=repo_name) }}?ref={{ current_ref }}" {% if request.endpoint == 'repo_commits' %}class="active"{% endif %}>Commits</a>
            <a href="{{ url_for('repo_refs', repo_name=repo_name) }}" {% if request.endpoint == 'repo_refs' %}class="active"{% endif %}>Refs</a>
            <a href="{{ url_for('repo_tree_path', repo_name=repo_name) }}?ref={{ current_ref }}" {% if request.endpoint in ['repo_tree_path', 'repo_blob_path', 'repo_blame_path'] %}class="active"{% endif %}>Tree</a>
            <a href="{{ url_for('repo_diff', repo_name=repo_name) }}?ref={{ current_ref }}" {% if request.endpoint == 'repo_diff' %}class="active"{% endif %}>Diff</a>
            {% endif %}
        </div>
        {% if refs %}
        <select onchange="changeRef(this.value)">
            {% for ref in refs %}
            <option value="{{ ref.shorthand }}" {% if ref.shorthand == current_ref %}selected{% endif %}>{{ ref.name }}</option>
            {% endfor %}
        </select>
        {% endif %}
    </nav>
    <script>
        function changeRef(newRef) {
            const url = new URL(window.location);
            url.searchParams.set('ref', newRef);
            window.location = url;
        }
    </script>
        </nav>
    <div class="content">
    {% block content %}{% endblock %}
    </div>
</body>
</html>
</body>
</html>