{% extends "base.html" %}

{% block content %}
{% if error %}
<p>Error: {{ error }}</p>
{% endif %}

{% if diff %}
<h2>Diff between {{ diff.ref1 }} and {{ diff.ref2 }}</h2>

<form method="get" action="">
    <label for="id1">From:</label>
    <input type="text" name="id1" value="{{ diff.ref1 }}" id="id1">
    <label for="id2">To:</label>
    <input type="text" name="id2" value="{{ diff.ref2 }}" id="id2">
    <label for="context_lines">Context Lines:</label>
    <input type="number" name="context_lines" value="{{ context_lines }}" id="context_lines" min="0">
    <label for="interhunk_lines">Interhunk Lines:</label>
    <input type="number" name="interhunk_lines" value="{{ interhunk_lines }}" id="interhunk_lines" min="0">
    <button type="submit">Update Diff</button>
</form>

<h3>Changed Files</h3>
<table>
    <thead style="font-weight: bold;">
        <tr>
            <td>File</td>
            <td>Additions</td>
            <td>Deletions</td>
            <td>Status</td>
        </tr>
    </thead>
    <tbody>
        {% for file in diff.files %}
        <tr>
            <td>{{ file.file }}</td>
            <td style="color: green;">+{{ file.additions }}</td>
            <td style="color: red;">-{{ file.deletions }}</td>
            <td>{{ file.status }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<h3>Full Patch</h3>
<div>
{{ highlighted_patch|safe }}
</div>
{% endif %}
{% endblock %}